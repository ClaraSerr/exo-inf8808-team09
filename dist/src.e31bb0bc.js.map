{"version":3,"sources":["scripts/helper.js","scripts/heatmap.js","scripts/preprocess.js","scripts/grouped-quantile.js","index.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["generateMapG","width","height","d3","select","append","attr","generateMarkerG","setCanvasSize","appendGraphLabels","g","text","initPanelDiv","style","getSimulation","data","forceSimulation","features","alphaDecay","velocityDecay","force","forceCollide","strength","simulate","simulation","on","selectAll","d","x","y","getProjection","geoMercator","center","scale","getPath","projection","geoPath","getClosestStep","nSteps","domain","BEST_STEPS","step","stepDiff","bestStep","length","i","push","Math","abs","getSteps","steps","unshift","drawHeatmap","vizData","ligne","girouette","indicateur","posLigne","findIndex","e","posGirouette","girouettes","v","voyages","a","arrets","valueSquare","addDayType","jour_semaine","date","getDay","type_jour","isNaN","voyage","ferie","aggregateData","csvData","startDate","endDate","typeJour","Girouette","posVoyage","posArret","codeArret","arret_code","nomArret","arret_nom","minutesEcart","moyMinutesEcart","nClients","moyNClients","ponctualite","tauxPonctualite","minutesEcartClient","moyMinutesEcartClient","Minutes_ecart_planifie","montants","Etat_Ponctualite","average","arr","reduce","b","toFixed","computeTauxPonctualite","filter","forEach","arret","MARGIN","top","right","bottom","left","FONT_SIZE","DIRECTIONS_ANGLE","QUANTILE_STROKE_COLOR","QUANTILE_FILL_COLOR","QUANTILE_STROKE_WIDTH","NUMBER_OF_TICKS","GRADIENT_COLORS","generateViz3","container","delayGraphContainer","trafficGraphContainer","lines","directions","ResizeObserver","generateDelayGraph","observe","node","generateTrafficGraph","quantileSets","title","generateGroupedQuantileGraph","svg","dataScale","WIDTH","getBoundingClientRect","HEIGHT","enter","insert","html","BAR_WIDTH","linesScale","scaleOrdinal","range","directionsRange","line","directionsScale","maxValue","Number","MIN_SAFE_INTEGER","minValue","MAX_SAFE_INTEGER","quantiles","quantile","scaleLinear","xAxis","lineValuesY","directionValuesY","yAxis","helper","bars","q3","q2","q1","j","textBoundingClientRect","svgSize","Date","build","groupedQuantile","csv","then","sequence_arret","arret_Latitude","arret_Longitude","preprocess","console","log","heatmap","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","clear","hmrApply","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","document","body","appendChild","getElementById","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"src.e31bb0bc.js","sourceRoot":"..\\src","sourcesContent":["\r\n/**\r\n * Generates the SVG element g which will contain the map base.\r\n *\r\n * @param {number} width The width of the graph\r\n * @param {number} height The height of the graph\r\n * @returns {*} The d3 Selection for the created g element\r\n */\r\nexport function generateMapG (width, height) {\r\n  return d3.select('.graph')\r\n    .select('svg')\r\n    .append('g')\r\n    .attr('id', 'map-g')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n}\r\n\r\n/**\r\n * Generates the SVG element g which will contain the map markers.\r\n *\r\n * @param {number} width The width of the graph\r\n * @param {number} height The height of the graph\r\n * @returns {*} The d3 Selection for the created g element\r\n */\r\nexport function generateMarkerG (width, height) {\r\n  return d3.select('.graph')\r\n    .select('svg')\r\n    .append('g')\r\n    .attr('id', 'marker-g')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n}\r\n\r\n/**\r\n * Sets the size of the SVG canvas containing the graph.\r\n *\r\n * @param {number} width The desired width\r\n * @param {number} height The desired height\r\n */\r\nexport function setCanvasSize (width, height) {\r\n  d3.select('#map').select('svg')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n}\r\n\r\n/**\r\n * Appends the labels for the graph.\r\n *\r\n * @param {*} g The d3 Selection of the graph's g SVG element\r\n */\r\nexport function appendGraphLabels (g) {\r\n  g.append('text')\r\n    .text('Achalandage et ponctualité des lignes de bus 9 et 22 de la couronne Nord de Montréal')\r\n    .attr('class', 'title')\r\n    .attr('fill', '#000000')\r\n    .attr('font-family', 'myriad-pro')\r\n    .attr('font-size', 28)\r\n    .attr('transform', 'translate(50, 50)')\r\n\r\n  g.append('text')\r\n    .text('Sous-titre')\r\n    .attr('class', 'title')\r\n    .attr('fill', '#000000')\r\n    .attr('font-family', 'myriad-pro')\r\n    .attr('font-size', 18)\r\n    .attr('transform', 'translate(50, 85)')\r\n}\r\n\r\n/**\r\n * Initializes the div which will contain the information panel.\r\n */\r\nexport function initPanelDiv () {\r\n  d3.select('.graph')\r\n    .append('div')\r\n    .attr('id', 'panel')\r\n    .style('width', '215px')\r\n    .style('border', '1px solid black')\r\n    .style('padding', '10px')\r\n    .style('visibility', 'hidden')\r\n}\r\n\r\n/**\r\n * Initializes the simulation used to place the circles\r\n *\r\n * @param {object} data The data to be displayed\r\n * @returns {*} The generated simulation\r\n */\r\nexport function getSimulation (data) {\r\n  return d3.forceSimulation(data.features)\r\n    .alphaDecay(0)\r\n    .velocityDecay(0.75)\r\n    .force('collision',\r\n      d3.forceCollide(5)\r\n        .strength(1)\r\n    )\r\n}\r\n\r\n/**\r\n * Update the (x, y) position of the circles'\r\n * centers on each tick of the simulation.\r\n *\r\n * @param {*} simulation The simulation used to position the cirles.\r\n */\r\nexport function simulate (simulation) {\r\n  simulation.on('tick', () => {\r\n    d3.selectAll('.marker')\r\n      .attr('cx', (d) => d.x)\r\n      .attr('cy', (d) => d.y)\r\n  })\r\n}\r\n\r\n/**\r\n * Sets up the projection to be used.\r\n *\r\n * @returns {*} The projection to use to trace the map elements\r\n */\r\nexport function getProjection () {\r\n  return d3.geoMercator()\r\n    .center([-73.708879, 45.579611])\r\n    .scale(70000)\r\n}\r\n\r\n/**\r\n * Sets up the path to be used.\r\n *\r\n * @param {*} projection The projection used to trace the map elements\r\n * @returns {*} The path to use to trace the map elements\r\n */\r\nexport function getPath (projection) {\r\n  return d3.geoPath()\r\n    .projection(projection)\r\n}\r\n/**\r\n * @param {number} nSteps The ideal number of steps\r\n * @param {*} domain Domain of d3 scale\r\n * @returns {number} The best step to use\r\n */\r\n export function getClosestStep (nSteps, domain) {\r\n  const BEST_STEPS = [\r\n    0.1, 0.2, 0.25, 0.5,\r\n    1, 2, 2.5, 5,\r\n    10, 20, 25, 50,\r\n    100, 200, 250, 500,\r\n    1000, 2000, 2500, 5000,\r\n    10000, 20000, 25000, 50000\r\n  ]\r\n  var step = (domain[1] - domain[0]) / nSteps\r\n  var stepDiff = []\r\n  var bestStep = BEST_STEPS[BEST_STEPS.length - 1]\r\n  for (let i = 0; i < BEST_STEPS.length; i++) {\r\n    stepDiff.push(Math.abs(BEST_STEPS[i] - step))\r\n    if (i > 0 && stepDiff[i] > stepDiff[i - 1]) {\r\n      bestStep = BEST_STEPS[i - 1]\r\n      break\r\n    }\r\n  }\r\n  return bestStep\r\n}\r\n\r\n/**\r\n * @param {number} nSteps The ideal number of steps\r\n * @param {*} domain Domain of d3 scale\r\n * @returns {Array<number>} The best steps\r\n */\r\nexport function getSteps (nSteps, domain) {\r\n  var step = getClosestStep(nSteps, domain)\r\n  var steps = []\r\n  if (domain[0] <= 0 && domain[1] >= 0) {\r\n    steps.push(0)\r\n  } else {\r\n    steps.push(domain[0])\r\n  }\r\n  while (steps[steps.length - 1] < domain[1] - step) {\r\n    steps.push(steps[steps.length - 1] + step)\r\n  }\r\n  while (steps[0] > domain[0] + step) {\r\n    steps.unshift(steps[0] - step)\r\n  }\r\n  return steps\r\n}","// Idée générale pour l'algorithme qui parcours l'objet vizData pour recueillir les valeurs pour chaque carré de la heatmap.\r\n\r\n/**\r\n * @param vizData\r\n * @param ligne\r\n * @param girouette\r\n * @param indicateur\r\n */\r\nexport function drawHeatmap (vizData, ligne, girouette, indicateur) {\r\n  var posLigne = vizData.findIndex(e => e.ligne === ligne)\r\n  var posGirouette = vizData[posLigne].girouettes.findIndex(e => e.girouette === girouette)\r\n\r\n  for (var v = 0; v < vizData[posLigne].girouettes[posGirouette].voyages.length; v++) {\r\n    for (var a = 0; a < vizData[posLigne].girouettes[posGirouette].voyages[v].arrets.length; a++) {\r\n      var valueSquare = vizData[posLigne].girouettes[posGirouette].voyages[v].arrets[a][indicateur]\r\n      //console.log(valueSquare)\r\n    }\r\n  }\r\n}\r\n","// INF8808 - Exo\r\n//\r\n// Adam Prévost - 1947205\r\n// Armelle Jézéquel - 2098157\r\n// Clara Serruau - 2164678\r\n// Jules Lefebvre - 1847158\r\n// Julien Dupuis - 1960997\r\n//\r\n\r\n/**\r\n * Ajout de champs à l'objet\r\n * jour_semaine {0, 1, 2, 3, 4, 5, 6} où 0 = Dimanche\r\n * type_jour {semaine, fin de semaine}\r\n * ferie {true, false}\r\n *\r\n * @param {object[]} data L'array d'objets qui contient les lignes du csv\r\n */\r\nexport function addDayType (data) {\r\n  for (var i = 0; i < data.length; i++) {\r\n    // jour_semaine\r\n    data[i].jour_semaine = data[i].date.getDay()\r\n\r\n    // type_jour\r\n    data[i].jour_semaine === (0 || 6) ? data[i].type_jour = 'fin de semaine' : data[i].type_jour = 'semaine'\r\n\r\n    // ferie\r\n    isNaN(data[i].voyage) ? data[i].ferie = true : data[i].ferie = false\r\n  }\r\n}\r\n/**\r\n * aggregateData() remplit l'objet vizData à partir des données du csv (data)\r\n *\r\n * @param {*} csvData L'array d'objets qui contient les lignes du csv, modifié par preprocess.addDayType()\r\n * @param {*} vizData L'array d'objets qui contient les données consolidées requises pour générer les viz\r\n * @param {*} startDate Date de début\r\n * @param {*} endDate Date de fin\r\n * @param {*} typeJour On considère semaine ou weekend\r\n * @param {*} ferie On considère les fériés si true\r\n */\r\nexport function aggregateData (csvData, vizData, startDate, endDate, typeJour, ferie) {\r\n  // Boucle sur les lignes de csvData pour remplir la structure vizData\r\n  for (var i = 0; i < csvData.length; i++) {\r\n    if (csvData[i].date >= startDate && csvData[i].date <= endDate && csvData[i].type_jour === typeJour && csvData[i].ferie === ferie) {\r\n      if (vizData.length === 0) {\r\n        vizData.push({ ligne: csvData[i].ligne, girouettes: [] })\r\n      }\r\n\r\n      // On ajoute la ligne si elle n'existe pas déjà dans vizData\r\n      var posLigne = vizData.findIndex(e => e.ligne === csvData[i].ligne)\r\n      if (posLigne === -1) {\r\n        vizData.push({ ligne: csvData[i].ligne, girouettes: [] })\r\n        posLigne = vizData.length - 1\r\n      }\r\n\r\n      // On ajoute la girouette si elle n'existe pas déjà dans vizData\r\n      var posGirouette = vizData[posLigne].girouettes.findIndex(e => e.girouette === csvData[i].Girouette)\r\n      if (posGirouette === -1) {\r\n        vizData[posLigne].girouettes.push({ girouette: csvData[i].Girouette, voyages: [] })\r\n        posGirouette = vizData[posLigne].girouettes.length - 1\r\n      }\r\n\r\n      // On ajoute le voyage s'il n'existe pas déjà dans vizData\r\n      var posVoyage = vizData[posLigne].girouettes[posGirouette].voyages.findIndex(e => e.voyage === csvData[i].voyage)\r\n      if (posVoyage === -1) {\r\n        vizData[posLigne].girouettes[posGirouette].voyages.push({ voyage: csvData[i].voyage, arrets: [] })\r\n        posVoyage = vizData[posLigne].girouettes[posGirouette].voyages.length - 1\r\n      }\r\n\r\n      // On ajoute l'arrêt s'il n'existe pas déjà dans vizData\r\n      var posArret = vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets.findIndex(e => e.codeArret === csvData[i].arret_code)\r\n      if (posArret === -1) {\r\n        vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets.push(\r\n          {\r\n            codeArret: csvData[i].arret_code,\r\n            nomArret: csvData[i].arret_nom,\r\n            minutesEcart: [],\r\n            moyMinutesEcart: null,\r\n            nClients: [],\r\n            moyNClients: null,\r\n            ponctualite: [],\r\n            tauxPonctualite: null,\r\n            minutesEcartClient: [],\r\n            moyMinutesEcartClient: null\r\n          })\r\n        posArret = vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets.length - 1\r\n      }\r\n\r\n      vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets[posArret].minutesEcart.push(csvData[i].Minutes_ecart_planifie)\r\n      vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets[posArret].nClients.push(csvData[i].montants)\r\n      vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets[posArret].ponctualite.push(csvData[i].Etat_Ponctualite)\r\n      vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets[posArret].minutesEcartClient.push(csvData[i].Minutes_ecart_planifie * csvData[i].montants)\r\n    }\r\n  }\r\n\r\n  // Fonctions pour créer les indicateurs\r\n  const average = arr => +(arr.reduce((a, b) => a + b, 0) / arr.length).toFixed(2) // https://poopcode.com/calculate-the-average-of-an-array-of-numbers-in-javascript/\r\n  const computeTauxPonctualite = arr => arr.filter(x => x === 'Ponctuel').length / arr.length\r\n\r\n  // Parcours de vizData pour calculer les indicateurs pour chaque ligne.arret\r\n  vizData.forEach(function (ligne) {\r\n    ligne.girouettes.forEach(function (girouette) {\r\n      girouette.voyages.forEach(function (voyage) {\r\n        voyage.arrets.forEach(function (arret) {\r\n          arret.moyMinutesEcart = average(arret.minutesEcart)\r\n          arret.moyNClients = average(arret.nClients)\r\n          arret.moyMinutesEcartClient = average(arret.minutesEcartClient)\r\n          arret.tauxPonctualite = computeTauxPonctualite(arret.ponctualite)\r\n        })\r\n      })\r\n    })\r\n  })\r\n}\r\n","import * as helper from './helper.js'\r\n\r\nconst MARGIN = { top: 100, right: 80, bottom: 150, left: 150 }\r\nconst FONT_SIZE = 16\r\nconst DIRECTIONS_ANGLE = -45\r\nconst QUANTILE_STROKE_COLOR = 'black'\r\nconst QUANTILE_FILL_COLOR = 'lightgray'\r\nconst QUANTILE_STROKE_WIDTH = 2\r\nconst NUMBER_OF_TICKS = 10\r\nconst GRADIENT_COLORS = ['#ffe4e4', '#e4ffe4', '#ffffe4']\r\n\r\n/**\r\n *\r\n */\r\nexport function generateViz3 () {\r\n  // Split container in two\r\n  var container = d3.select('#grouped-quantile-graph-container')\r\n  var delayGraphContainer = container.append('div')\r\n    .style('width', '50%')\r\n    .style('height', '100%')\r\n    .style('float', 'left')\r\n  var trafficGraphContainer = container.append('div')\r\n    .style('width', '50%')\r\n    .style('height', '100%')\r\n    .style('float', 'right')\r\n\r\n  // TODO: Fetch data\r\n  var data = {}\r\n  data.lines = ['9', '22']\r\n  data.directions = ['Lafontaine', 'Montmorency', 'Côté', 'George VI']\r\n\r\n  // Regenerate graphs on resize\r\n  new ResizeObserver(() => { generateDelayGraph(delayGraphContainer, data) })\r\n    .observe(delayGraphContainer.node())\r\n  new ResizeObserver(() => { generateTrafficGraph(trafficGraphContainer, data) })\r\n    .observe(trafficGraphContainer.node())\r\n}\r\n\r\n/**\r\n * @param {Selection} container The div to generate the graph in\r\n * @param {object} data The data to fetch\r\n */\r\nexport function generateDelayGraph (container, data) {\r\n  // TODO: Fetch data\r\n  data.quantileSets = [\r\n    [10, 20, 30, 40, 50],\r\n    [-5, 25, 40, 50, 70],\r\n    [15, 20, 55, 60, 65],\r\n    [40, 50, 60, 70, 90]\r\n  ]\r\n\r\n  // Generate common graph\r\n  data.title = 'Retard Moyen'\r\n  var [svg, dataScale] = generateGroupedQuantileGraph(container, data)\r\n  var WIDTH = container.node().getBoundingClientRect().width\r\n  var HEIGHT = container.node().getBoundingClientRect().height\r\n\r\n  // Set gradients\r\n  svg.append('defs')\r\n    .append('linearGradient')\r\n    .attr('id', 'late-grad')\r\n    .attr('x1', '0%')\r\n    .attr('x2', '0%')\r\n    .attr('y1', '0%')\r\n    .attr('y2', '100%')\r\n    .selectAll('stop')\r\n    .data([GRADIENT_COLORS[0], GRADIENT_COLORS[1]])\r\n    .enter()\r\n    .append('stop')\r\n    .style('stop-color', function (d) { return d })\r\n    .attr('offset', function (d, i) { return 100 * i + '%' })\r\n  svg.append('defs')\r\n    .append('linearGradient')\r\n    .attr('id', 'early-grad')\r\n    .attr('x1', '0%')\r\n    .attr('x2', '0%')\r\n    .attr('y1', '0%')\r\n    .attr('y2', '100%')\r\n    .selectAll('stop')\r\n    .data([GRADIENT_COLORS[1], GRADIENT_COLORS[2]])\r\n    .enter()\r\n    .append('stop')\r\n    .style('stop-color', function (d) { return d })\r\n    .attr('offset', function (d, i) { return 100 * i + '%' })\r\n  // Draw gradients\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', dataScale(15) - MARGIN.top)\r\n    .attr('y', MARGIN.top)\r\n    .attr('fill', GRADIENT_COLORS[0])\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', dataScale(5) - dataScale(15))\r\n    .attr('y', dataScale(15))\r\n    .attr('fill', 'url(#late-grad)')\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', dataScale(-5) - dataScale(5))\r\n    .attr('y', dataScale(5))\r\n    .attr('fill', 'url(#early-grad)')\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', HEIGHT - MARGIN.bottom - dataScale(-5))\r\n    .attr('y', dataScale(-5))\r\n    .attr('fill', GRADIENT_COLORS[2])\r\n  // Set y axis label\r\n  svg.select('#y-axis > .label')\r\n    .text('Minute')\r\n}\r\n\r\n/**\r\n * @param {Selection} container The div to generate the graph in\r\n * @param {object} data The data to fetch\r\n */\r\nexport function generateTrafficGraph (container, data) {\r\n  // TODO: Fetch data\r\n  data.quantileSets = [\r\n    [100, 200, 300, 350, 500],\r\n    [50, 200, 250, 600, 650],\r\n    [200, 350, 400, 600, 700],\r\n    [450, 500, 600, 700, 750]\r\n  ]\r\n\r\n  // Generate common graph\r\n  data.title = 'Achalandage Moyen'\r\n  var [svg] = generateGroupedQuantileGraph(container, data)\r\n  // Set y axis label\r\n  svg.select('#y-axis > .label')\r\n    .text('Nombre de personnes\\npar jour')\r\n}\r\n\r\n/**\r\n * @param {Selection} container The div to generate the graph in\r\n * @param {object} data The data to display\r\n * @returns {Selection} The generated graph as svg\r\n */\r\nexport function generateGroupedQuantileGraph (container, data) {\r\n  // ===================== SETUP =====================\r\n\r\n  // Delete existing content\r\n  container.html('')\r\n  // Set size\r\n  var WIDTH = container.node().getBoundingClientRect().width\r\n  var HEIGHT = container.node().getBoundingClientRect().height\r\n  var BAR_WIDTH = (WIDTH - MARGIN.left - MARGIN.right) / 7\r\n  // Create svg\r\n  var svg = container.append('svg')\r\n    .attr('width', WIDTH)\r\n    .attr('height', HEIGHT)\r\n\r\n  // ===================== SCALES =====================\r\n\r\n  // Create lines scale\r\n  var linesScale = d3.scaleOrdinal()\r\n    .domain(data.lines)\r\n    .range([MARGIN.left + 2 * BAR_WIDTH, MARGIN.left + 5 * BAR_WIDTH])\r\n  // Create directions scale\r\n  var directionsRange = []\r\n  for (const line of data.lines) {\r\n    directionsRange.push(linesScale(line) - BAR_WIDTH / 2)\r\n    directionsRange.push(linesScale(line) + BAR_WIDTH / 2)\r\n  }\r\n  var directionsScale = d3.scaleOrdinal()\r\n    .domain([...data.directions])\r\n    .range(directionsRange)\r\n  // Create data scale\r\n  var maxValue = Number.MIN_SAFE_INTEGER\r\n  var minValue = Number.MAX_SAFE_INTEGER\r\n  for (const quantiles of data.quantileSets) {\r\n    for (const quantile of quantiles) {\r\n      if (maxValue < quantile) {\r\n        maxValue = quantile\r\n      }\r\n      if (minValue > quantile) {\r\n        minValue = quantile\r\n      }\r\n    }\r\n  }\r\n  var dataScale = d3.scaleLinear()\r\n    .domain([minValue, maxValue])\r\n    .range([HEIGHT - MARGIN.bottom - FONT_SIZE, MARGIN.top])\r\n\r\n  // ===================== X AXIS =====================\r\n\r\n  var xAxis = svg.append('g')\r\n    .attr('id', 'x-axis')\r\n  // Draw axis line\r\n  xAxis.append('path')\r\n    .attr('d', d3.line()([\r\n      [MARGIN.left, HEIGHT - MARGIN.bottom],\r\n      [MARGIN.left + 7 * BAR_WIDTH, HEIGHT - MARGIN.bottom]\r\n    ]))\r\n    .attr('stroke', 'black')\r\n  // Draw line values\r\n  const lineValuesY = HEIGHT - MARGIN.bottom + FONT_SIZE * 1.5\r\n  for (const line of data.lines) {\r\n    xAxis.append('text')\r\n      .attr('x', linesScale(line))\r\n      .attr('y', lineValuesY)\r\n      .attr('text-anchor', 'middle')\r\n      .text(line)\r\n      .style('font-size', FONT_SIZE)\r\n  }\r\n  // Draw direction values\r\n  const directionValuesY = lineValuesY + FONT_SIZE\r\n  for (let i = 0; i < data.directions.length; i++) {\r\n    const x = directionsScale(data.directions[i])\r\n    xAxis.append('text')\r\n      .attr('text-anchor', 'end')\r\n      .attr('transform', `translate(${x}, ${directionValuesY}) rotate(${DIRECTIONS_ANGLE})`)\r\n      .text(data.directions[i])\r\n      .style('font-size', FONT_SIZE)\r\n      .attr('class', `direction${i} label`)\r\n  }\r\n  // Draw labels\r\n  xAxis.append('text')\r\n    .attr('x', WIDTH - MARGIN.right + FONT_SIZE / 2)\r\n    .attr('y', lineValuesY)\r\n    .text('Ligne')\r\n    .style('font-size', FONT_SIZE)\r\n  xAxis.append('text')\r\n    .attr('x', WIDTH - MARGIN.right + FONT_SIZE / 2)\r\n    .attr('y', directionValuesY + FONT_SIZE)\r\n    .text('Direction')\r\n    .style('font-size', FONT_SIZE)\r\n\r\n  // ===================== Y AXIS =====================\r\n\r\n  var yAxis = svg.append('g')\r\n    .attr('id', 'y-axis')\r\n  // Draw axis line\r\n  yAxis.append('path')\r\n    .attr('d', d3.line()([\r\n      [MARGIN.left, MARGIN.top],\r\n      [MARGIN.left, HEIGHT - MARGIN.bottom]\r\n    ]))\r\n    .attr('stroke', 'black')\r\n  // Generate steps\r\n  var steps = helper.getSteps(NUMBER_OF_TICKS, dataScale.domain())\r\n  for (const step of steps) {\r\n    const y = dataScale(step)\r\n    // Draw data values\r\n    yAxis.append('text')\r\n      .attr('text-anchor', 'end')\r\n      .attr('x', MARGIN.left - FONT_SIZE)\r\n      .attr('y', y + FONT_SIZE / 2)\r\n      .text(step)\r\n      .style('font-size', FONT_SIZE)\r\n    // Draw ticks\r\n    yAxis.append('path')\r\n      .attr('d', d3.line()([\r\n        [MARGIN.left - FONT_SIZE / 2, y],\r\n        [MARGIN.left, y]]\r\n      ))\r\n      .attr('stroke', QUANTILE_STROKE_COLOR)\r\n      .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n  }\r\n  // Draw labels\r\n  yAxis.append('text')\r\n    .attr('x', MARGIN.left - FONT_SIZE / 2)\r\n    .attr('y', MARGIN.top - FONT_SIZE / 2)\r\n    .attr('class', 'label')\r\n    .attr('text-anchor', 'end')\r\n    .text('Unité de données')\r\n    .style('font-size', FONT_SIZE)\r\n\r\n  // ===================== CANDLES =====================\r\n\r\n  var bars = svg.append('g')\r\n    .attr('id', 'candles')\r\n  for (let i = 0; i < data.quantileSets.length; i++) {\r\n    const x = directionsScale(data.directions[i])\r\n    const top = dataScale(data.quantileSets[i][4])\r\n    const q3 = dataScale(data.quantileSets[i][3])\r\n    const q2 = dataScale(data.quantileSets[i][2])\r\n    const q1 = dataScale(data.quantileSets[i][1])\r\n    const bottom = dataScale(data.quantileSets[i][0])\r\n    // Draw domain line\r\n    bars.append('path')\r\n      .attr('d', d3.line()([[x, top], [x, bottom]]))\r\n      .attr('stroke', QUANTILE_STROKE_COLOR)\r\n      .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n      .attr('class', `direction${i}`)\r\n    // Draw Q1 to Q3 bar\r\n    bars.append('rect')\r\n      .attr('width', BAR_WIDTH)\r\n      .attr('x', x - BAR_WIDTH / 2)\r\n      .attr('height', q1 - q3)\r\n      .attr('y', q3)\r\n      .attr('fill', QUANTILE_FILL_COLOR)\r\n      .attr('stroke', QUANTILE_STROKE_COLOR)\r\n      .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n      .attr('class', `direction${i}`)\r\n    // Draw Q2 line\r\n    bars.append('path')\r\n      .attr('d', d3.line()([[x - BAR_WIDTH / 2, q2], [x + BAR_WIDTH / 2, q2]]))\r\n      .attr('stroke', QUANTILE_STROKE_COLOR)\r\n      .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n      .attr('class', `direction${i}`)\r\n    // Draw quantile values\r\n    for (let j = 0; j < data.quantileSets[i].length; j++) {\r\n      const quantile = bars.append('g')\r\n        .attr('class', `direction${i} quantile`)\r\n        .style('visibility', 'hidden')\r\n      quantile.append('text')\r\n        .attr('x', directionsScale(data.directions[i]) + (i % 2 === 0 ? -1 : 1) * (BAR_WIDTH / 2 + FONT_SIZE / 2))\r\n        .attr('y', dataScale(data.quantileSets[i][j]))\r\n        .attr('text-anchor', (i % 2 === 0 ? 'end' : 'start'))\r\n        .text(data.quantileSets[i][j])\r\n        .style('font-size', FONT_SIZE)\r\n        .attr('id', `quantile-text-${i}-${j}`)\r\n      // Text background\r\n      const textBoundingClientRect = quantile.node().getBoundingClientRect()\r\n      quantile.insert('rect', `#quantile-text-${i}-${j}`)\r\n        .attr('width', textBoundingClientRect.width)\r\n        .attr('x', textBoundingClientRect.x)\r\n        .attr('height', textBoundingClientRect.height)\r\n        .attr('y', textBoundingClientRect.y)\r\n        .attr('fill', 'white')\r\n    }\r\n  }\r\n\r\n  // ===================== HOVER =====================\r\n\r\n  // Create triggers\r\n  for (let i = 0; i < data.directions.length; i++) {\r\n    bars.append('rect')\r\n      .attr('width', BAR_WIDTH)\r\n      .attr('x', directionsScale(data.directions[i]) - BAR_WIDTH / 2)\r\n      .attr('height', dataScale.range()[0] - dataScale.range()[1] + FONT_SIZE)\r\n      .attr('y', MARGIN.top)\r\n      .attr('fill', 'transparent')\r\n      // Highlight direction\r\n      .on('mouseover', () => {\r\n        d3.selectAll(`.direction${i}`)\r\n          .attr('stroke-width', QUANTILE_STROKE_WIDTH * 2)\r\n        d3.selectAll(`.direction${i}.label`)\r\n          .style('font-size', FONT_SIZE * 1.5)\r\n        d3.selectAll(`.direction${i}.quantile`)\r\n          .style('visibility', 'visible')\r\n      // Unhighlight direction\r\n      }).on('mouseout', () => {\r\n        d3.selectAll(`.direction${i}`)\r\n          .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n        d3.selectAll(`.direction${i}.label`)\r\n          .style('font-size', FONT_SIZE)\r\n        d3.selectAll(`.direction${i}.quantile`)\r\n          .style('visibility', 'hidden')\r\n      })\r\n  }\r\n\r\n  // ===================== OTHER =====================\r\n\r\n  // Draw Title\r\n  svg.append('text')\r\n    .attr('x', (WIDTH - MARGIN.right - MARGIN.left) / 2 + MARGIN.left)\r\n    .attr('y', MARGIN.top - FONT_SIZE * 2)\r\n    .attr('text-anchor', 'middle')\r\n    .text(data.title)\r\n    .style('font-size', FONT_SIZE)\r\n\r\n  return [svg, dataScale]\r\n}","'use strict'\r\n\r\nimport * as helper from './scripts/helper.js'\r\nimport * as heatmap from './scripts/heatmap.js'\r\nimport * as preprocess from './scripts/preprocess.js'\r\nimport * as groupedQuantile from './scripts/grouped-quantile.js'\r\n\r\n/**\r\n * @file \r\n * @author Adam Prévost, Armelle Jézéquel, Clara Serruau, Jules Lefebvre, Julien Dupuis\r\n * @version 1.0.0\r\n * \r\n * La structure du projet est inspirée de celle employé pour les TPs de INF8808 créée par Olivia Gélinas.\r\n */\r\n\r\n(function (d3) {\r\n  const svgSize = {\r\n    width: 800,\r\n    height: 625\r\n  }\r\n\r\n  helper.setCanvasSize(svgSize.width, svgSize.height)\r\n  helper.generateMapG(svgSize.width, svgSize.height)\r\n  helper.generateMarkerG(svgSize.width, svgSize.height)\r\n  helper.appendGraphLabels(d3.select('.main-svg'))\r\n  helper.initPanelDiv()\r\n\r\n  // Solution temporaire, éventuellement l'utilisateur peut choisir la période qui l'intéresse, s'il veut inclure les week-end et les fériés.\r\n  const startDate = new Date('2021-09-01')\r\n  const endDate = new Date('2021-12-01')\r\n  const typeJour = 'semaine'\r\n  const ferie = false\r\n\r\n  var vizData = []\r\n\r\n  build()\r\n  groupedQuantile.generateViz3();\r\n\r\n  /**\r\n   *   Cette fonction construit la page web\r\n   */\r\n  function build () {\r\n    d3.csv('./donnees_L9_L22.csv').then(function (csvData) {\r\n      // Change les string pour les types appropriés\r\n      csvData.forEach(function (d) {\r\n        d.date = new Date(d.date + ' 00:00:00')\r\n        d.ligne = +d.ligne\r\n        d.voyage = +d.voyage\r\n        d.arret_code = +d.arret_code\r\n        d.montants = +d.montants\r\n        d.Minutes_ecart_planifie = +d.Minutes_ecart_planifie\r\n        d.sequence_arret = +d.sequence_arret\r\n        d.arret_Latitude = +d.arret_Latitude\r\n        d.arret_Longitude = +d.arret_Longitude\r\n      })\r\n      //console.log(csvData)\r\n      preprocess.addDayType(csvData)\r\n      preprocess.aggregateData(csvData, vizData, startDate, endDate, typeJour, ferie)\r\n      console.log(vizData)\r\n      heatmap.drawHeatmap(vizData, 9, 'Lafontaine Via Gare  Saint-Jérôme', 'moyMinutesEcart')\r\n    })\r\n  }\r\n})(d3)\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}